<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>动态图表</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: transparent;
        }
        canvas { max-width: 800px; margin: 20px auto; }
        .bar-height { transform: scaleY(2); transform-origin: bottom; }
        h2 {
            text-align: center;
        }
    </style>
</head>
<body>
    <h2>2019年-2023年生产总值及增速</h2>
    <canvas id="myChart"></canvas>
    <h2>2020年三次产业及其增长率</h2>
    <canvas id="pieChart" style="max-width: 400px; margin: 20px auto;"></canvas>

    <script>
        const data = {
            labels: ['2019年', '2020年', '2021年', '2022年', '2023年'],
            barData: [328579, 307241, 352376, 369294, 408035], // 生产总值 (万元)
            lineData: [7.3, -9.6, 10.1, 0.2, 7.8], // 增速 (%)
            pieData: {
                '2020年': {
                    labels: ['第一次产业', '第二次产业', '第三次产业'],
                    data: [1.3, 2.97, 95.73]
                }
            }
        };


        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [data.labels[0]],
                datasets: [{
                    label: '生产总值 (万元)',
                    data: [data.barData[0]],
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1,
                    barPercentage: 0.5,
                    categoryPercentage: 0.8
                }, {
                    label: '增速 (%)',
                    data: [data.lineData[0]],
                    type: 'line',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 2,
                    fill: false,
                    yAxisID: 'y1'
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: '生产总值 (万元)' },
                        position: 'left'
                    },
                    y1: {
                        beginAtZero: true,
                        title: { display: true, text: '增速 (%)' },
                        position: 'right',
                        grid: { drawOnChartArea: false }
                    }
                },
                animation: { duration: 1000 }
            }
        });


        const pieCtx = document.getElementById('pieChart').getContext('2d');
        const pieChart = new Chart(pieCtx, {
            type: 'pie',
            data: {
                labels: data.pieData['2020年'].labels,
                datasets: [{
                    data: data.pieData['2020年'].data,
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.6)', // 第一次产业
                        'rgba(75, 192, 192, 0.6)', // 第二次产业
                        'rgba(255, 99, 132, 0.6)'  // 第三次产业
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                animation: { duration: 1000 }
            }
        });

        let currentYear = 0;
        function updateChart() {
            if (currentYear < data.labels.length) {
                myChart.data.labels = data.labels.slice(0, currentYear + 1);
                myChart.data.datasets[0].data = data.barData.slice(0, currentYear + 1);
                myChart.data.datasets[1].data = data.lineData.slice(0, currentYear + 1);
                myChart.update();
                currentYear++;
                setTimeout(updateChart, 1000);
            } else {

                currentYear = 0;
                myChart.data.labels = [data.labels[0]];
                myChart.data.datasets[0].data = [data.barData[0]];
                myChart.data.datasets[1].data = [data.lineData[0]];
                myChart.update();
                setTimeout(updateChart, 1000);
            }
        }


        setTimeout(updateChart, 1000);
    </script>
</body>
</html>